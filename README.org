#+TITLE:   README
#+DATE:    April 13, 2021
#+SINCE:   <replace with next tagged release version>
#+STARTUP: inlineimages nofold

* Table of Contents :TOC_1:noexport:
- [[#description][Description]]
- [[#features][Features]]
- [[#known-bugs][Known Bugs]]
- [[#installation-and-configuration][Installation and Configuration]]
- [[#keybindings][Keybindings]]
- [[#change-logs][Change logs]]

* Description
Emacs [[https://github.com/wallabag/wallabag][Wallabag]] client.
#+attr_org: :width 600px
[[file:homepage.png]]

* Features

- [x] Request all entries
- [x] Request all tags
- [x] Add tags for one entry
- [x] Delete tag for one entry
- [x] Request format for one entry
- [x] Add one entry
- [x] Add one entry with current buffer content (Only Emacs has this feature!)
- [x] Delete one entry
- [x] Copy as org links (Only Emacs has this feature!)
- [x] Offline database (Sqlite)
- [x] Full update
- [x] Real time search and filter
- [x] Sidebar supported: Tags
- [x] Select with Ivy
- [x] sync with all clients (mobile, web, browser extention etc)
- [x] Support [[https://github.com/chenyanming/shrface][shrface]]
- [ ] Advanced search and filtering
- [ ] Exporting.
- [ ] Editing.
- [ ] Batch Deletion.
- [ ] Batch Tagging.

* Known Bugs
There is one issue is that entries deletion on other platforms can not sync to emacs, the workaround is doing a full update via ~M-x wallabag-full-update~.

The mobile client also has the same behavior, when deletion performs on web client or wallabag.el, you need to do a full update on mobile.

* Installation and Configuration
This project relies on [[https://github.com/tkf/emacs-request][emacs-request]] and [[https://github.com/skeeto/emacsql][emacsql]]. Please install them in advanced.

#+begin_src sh
git clone https://github.com/chenyanming/wallabag.el.git ~/.emacs.d/lisp/wallabag/
#+end_src

** require
#+BEGIN_SRC emacs-lisp
(add-to-list 'load-path "~/.emacs.d/lisp/wallabag/")
(require 'wallabag)
(setq wallabag-host "https://xx.xx.xx") ;; wallabag server host name
(setq wallabag-username "xx") ;; username
(setq wallabag-password "xx") ;; password
(setq wallabag-clientid "xx") ;; created with API clients management
(setq wallabag-secret "xx") ;; created with API clients management
#+END_SRC

** use-package
#+begin_src emacs-lisp
(use-package wallabag
  :defer t
  :load-path "~/.emacs.d/lisp/wallabag/"
  :init
  (autoload 'wallabag "wallabag")
  :config
  (setq wallabag-host "https://xx.xx.xx") ;; wallabag server host name
  (setq wallabag-username "xx") ;; username
  (setq wallabag-password "xx") ;; password
  (setq wallabag-clientid "xx") ;; created with API clients management
  (setq wallabag-secret "xx") ;; created with API clients management
  ;; (setq wallabag-db-file "~/OneDrive/Org/wallabag.sqlite") ;; optional, default is saved to ~/.emacs.d/.cache/wallabag.sqlite
  ;; (run-with-timer 0 3540 'wallabag-request-token) ;; optional, auto refresh token, token should refresh every hour
  )
#+end_src

* Keybindings
Start with ~M-x wallabag~. The first time, you need to press ~u~, then input the number of articles you want to retrieve from the server.

** Functions can be used outside wallabag related modes
| wallabag               | Enter ~*wallabag-search*~ buffer.                                                                        |
| wallabag-find          | Select wallabag entries from a list with ivy.                                                          |
| wallabag-full-update   | Perform a full database update.                                                                        |
| wallabag-request-token | Request a new token.                                                                                   |
| wallabag-add-entry     | Add one entry to wallabag server, with URL and TAGS                                                    |
| wallabag-insert-entry  | Insert an entry to wallabag server with current buffer content (behavior may be changed in the future) |

** wallabag-search-mode

    | <RET>                  | wallabag-view                            | View the wallabag entry.                                             |
    | v                      | wallabag-view                            | View the wallabag entry.                                             |
    | s (non-evil), /(evil)  | wallabag-search-live-filter              | Filter the ~*wallabag-search*~ buffer.                                 |
    | q                      | wallabag-search-quit                     | Quit ~*wallabag-entry*~ then ~*wallabag-search*~ and ~*wallabag-sidebar*~. |
    | g (non-evil), r(evil)  | wallabag-search-refresh-and-clear-filter | Refresh wallabag and clear the filter keyword.                       |
    | G (non-evil), R(evil)  | wallabag-search-clear-filter             | Clear the filter keyword.                                            |
    | u                      | wallabag-search-update-and-clear-filter  | Request entries and clear the filter keyword.                        |
    | m                      | wallabag-mark-and-forward                | Mark entry and forward.                                              |
    | <DEL>                  | wallabag-unmark-and-backward             | Unmark entry and backword.                                           |
    | a                      | wallabag-add-entry                       | Add an entry.                                                        |
    | d                      | wallabag-delete-entry                    | Delete an entry.                                                     |
    | n(non-evil), j(evil)   | wallabag-next-entry                      | Move to next entry.                                                  |
    | p(non-evil), k(evil)   | wallabag-previous-entry                  | Move to previous entry.                                              |
    | w(non-evil), y(evil)   | wallabag-org-link-copy                   | Copy marked entries as org links.                                    |
    | t                      | wallabag-add-tags                        | Add tags (seperated by comma) to entry at point.                     |
    | T                      | wallabag-remove-tag                      | Remove one tag from list.                                            |
    | '                      | wallabag-toggle-sidebar                  | Toggle sidebar.                                                      |

** wallabag-entry-mode
    | q       | wallabag-entry-quit | Quit **wallabag-entry**. |
    | mouse-1 | wallabag-mouse-1    | Browse the url.        |
    | ret     | wallabag-ret        | Browse the url.        |

** wallabag-sidebar-mode

    | '                     | wallabag-toggle-sidebar            | Toggle sidebar.           |
    | <RET>                 | wallabag-sidebar-find-tag          | Filter by tag at point.   |
    | g (non-evil), r(evil) | wallabag-search-clear-filter       | Clear the filter keyword. |
    | G (non-evil), R(evil) | wallabag-search-clear-filter       | Clear the filter keyword. |
    | n                     | wallabag-sidebar-find-next-tag     | Filter by next tag.       |
    | p                     | wallabag-sidebar-find-previous-tag | Filter by previous tag.   |
    | q                     | wallabag-sidebar-quit              | Quit sidebar.             |

* Change logs
** =2021-04-13=
Version *1.0.0*:
